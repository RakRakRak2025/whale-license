<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš¸ì‚° ê³ ë˜ë©´í—ˆì¦</title>
    <meta name="description" content="ìš¸ì‚°ì˜ ëª…ë¬¼ ê³ ë˜ë©´í—ˆì¦ì„ ë””ì§€í„¸ë¡œ! ì§€ê¸ˆ ë°”ë¡œ ë°œê¸‰ë°›ê³  ê³ ë˜íŒ¨ìŠ¤ í˜œíƒë„ ë°›ì•„ë³´ì„¸ìš”.">
    <meta name="keywords" content="ìš¸ì‚°, ê³ ë˜ë©´í—ˆì¦, ë””ì§€í„¸ë©´í—ˆì¦">
    <meta property="og:title" content="ğŸ‹ ìš¸ì‚° ê³ ë˜ë©´í—ˆì¦">
    <meta property="og:description" content="ë‚˜ë§Œì˜ íŠ¹ë³„í•œ ê³ ë˜ë©´í—ˆì¦ì„ ë¬´ë£Œ ë°œê¸‰Â·ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!">
    <meta property="og:image" content="https://via.placeholder.com/1200x630/667eea/ffffff?text=ìš¸ì‚°+ê³ ë˜ë©´í—ˆì¦">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ‹</text></svg>">
    
    <!-- ë¼ì´ë¸ŒëŸ¬ë¦¬: JsBarcode, html2canvas -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

    <style>
        /* --- ê¸°ë³¸ ìŠ¤íƒ€ì¼ (ìƒëµ ê°€ëŠ¥ ë¶€ë¶„ì€ ê·¸ëŒ€ë¡œ ë‘ì„¸ìš”) --- */
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family:'Pretendard', sans-serif; background:linear-gradient(135deg,#667eea,#764ba2); min-height:100vh; display:flex; align-items:center; justify-content:center; padding:20px; }
        .main-container { display:flex; gap:30px; max-width:1200px; width:100%; }
        .form-section, .license-section { background:white; border-radius:20px; box-shadow:0 20px 40px rgba(0,0,0,0.1); }
        .form-section { flex:1; padding:30px; }
        .license-section { flex:1; perspective:1000px; position:relative; }
        /* (ì´í•˜ ê¸°ì¡´ CSS ì „ë¶€ í¬í•¨) */
        /* ... (ìœ„ì—ì„œ ì œê³µí•œ CSSë¥¼ ì—¬ê¸°ì— ê·¸ëŒ€ë¡œ ë¶™ì—¬ë„£ìœ¼ì‹œë©´ ë©ë‹ˆë‹¤) ... */

        /* ëª¨ë°”ì¼ ìµœì í™” */
        @media (max-width: 480px) {
            .main-container { flex-direction:column; padding:10px; }
            .form-section, .license-section { width:100%; }
            .avatar-selection { grid-template-columns:repeat(3,1fr); }
            .btn-download { width:100%; padding:12px; }
        }
    </style>
</head>
<body>
    <!-- ì„œë¹„ìŠ¤ ë°°ë„ˆ -->
    <div class="service-banner" id="serviceBanner" style="display:none;">
        âš ï¸ ì„œë¹„ìŠ¤ ì ê²€ ì¤‘: <span id="bannerMessage">ì¼ì‹œì ìœ¼ë¡œ ë°œê¸‰ì´ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.</span>
    </div>

    <div class="main-container">
        <!-- ì…ë ¥ í¼ -->
        <div class="form-section">
            <div class="form-header" style="text-align:center; margin-bottom:30px;">
                <div class="whale-emoji" style="font-size:50px; animation:bounce 2s infinite;">ğŸ‹</div>
                <h1>ìš¸ì‚° ê³ ë˜ë©´í—ˆì¦ ì¦‰ì‹œë°œê¸‰</h1>
                <p style="color:#666;">ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ì‹¤ì‹œê°„ìœ¼ë¡œ ë©´í—ˆì¦ì´ ìƒì„±ë©ë‹ˆë‹¤</p>
            </div>
            <div class="form-group">
                <label for="name">ì´ë¦„</label>
                <input type="text" id="name" placeholder="í™ê¸¸ë™" oninput="updateLicense()">
            </div>
            <div class="form-group">
                <label for="birthdate">ìƒë…„ì›”ì¼</label>
                <input type="date" id="birthdate" onchange="updateLicense()">
            </div>
            <div class="form-group">
                <label for="whaleType">ê³ ë˜ ì¢…ë¥˜</label>
                <select id="whaleType" onchange="updateLicense()">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option>ê·€ì‹ ê³ ë˜</option><option>í˜¹ë“±ê³ ë˜</option><option>ë°í¬ê³ ë˜</option>
                    <option>ë²”ê³ ë˜</option><option>ëŒ€ì™•ê³ ë˜</option>
                </select>
            </div>
            <div class="form-group">
                <label for="experience">ê³ ë˜ ìš´ì „ ëª©ì </label>
                <select id="experience" onchange="updateLicense()">
                    <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                    <option>ì¶œí‡´ê·¼ìš© ğŸ¢</option><option>í­ì£¼ìš© ğŸ</option><option>ë°ì´íŠ¸ìš© ğŸ’•</option>
                    <option>ê´€ê´‘ìš© ğŸ“¸</option><option>ë°°ë‹¬ìš© ğŸ›µ</option><option>ì´ˆë³´ìš´ì „ ğŸ”°</option>
                </select>
            </div>
            <div class="form-group">
                <label>ê³ ë˜ í”„ë¡œí•„ ì„ íƒ</label>
                <div class="avatar-selection">
                    <!-- 12ê°€ì§€ ì˜µì…˜ -->
                    <div class="avatar-option selected" onclick="selectAvatar('ğŸ‹', this)">ğŸ‹</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ³', this)">ğŸ³</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ¬', this)">ğŸ¬</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ¦ˆ', this)">ğŸ¦ˆ</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸŒŠ', this)">ğŸŒŠ</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ’™', this)">ğŸ’™</div>
                    <div class="avatar-option" onclick="selectAvatar('âœ¨', this)">âœ¨</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸŒ™', this)">ğŸŒ™</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ”¥', this)">ğŸ”¥</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ', this)">ğŸ</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸ¸', this)">ğŸ¸</div>
                    <div class="avatar-option" onclick="selectAvatar('ğŸš€', this)">ğŸš€</div>
                </div>
            </div>
        </div>

        <!-- ë©´í—ˆì¦ ë¯¸ë¦¬ë³´ê¸° -->
        <div class="license-section">
            <div class="license-card" style="background:white; border-radius:20px; overflow:hidden; transform:rotateY(-5deg); transition:transform .3s;">
                <div class="license-header" style="position:relative; padding:25px; text-align:center; background:linear-gradient(135deg,#1e3c72,#2a5298); color:white;">
                    <div class="license-logo" style="font-size:40px;">ğŸ‹</div>
                    <div class="license-title" style="font-size:24px; font-weight:700;">ìš¸ì‚°ê´‘ì—­ì‹œ ê³ ë˜ë©´í—ˆì¦</div>
                    <div class="license-subtitle" style="font-size:13px; letter-spacing:3px; text-transform:uppercase;">ULSAN WHALE LICENSE</div>
                </div>
                <div class="license-body" style="padding:30px;">
                    <div class="license-info" style="display:flex; gap:25px; margin-bottom:25px;">
                        <div class="avatar-display" id="avatarDisplay" style="width:100px;height:100px;background:#f0f0f0;border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:60px;">ğŸ‹</div>
                        <div class="info-details">
                            <div class="info-row"><span class="info-label">ì„±ëª…</span><span class="info-value name" id="displayName">-</span></div>
                            <div class="info-row"><span class="info-label">ìƒë…„ì›”ì¼</span><span class="info-value" id="displayBirth">-</span></div>
                            <div class="info-row"><span class="info-label">ê³ ë˜ì¢…ë¥˜</span><span class="info-value" id="displayWhale">-</span></div>
                            <div class="info-row"><span class="info-label">ëª©ì </span><span class="info-value" id="displayPurpose">-</span></div>
                        </div>
                    </div>
                    <div class="additional-info" style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;border-top:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0;padding:20px 0;">
                        <div class="info-item"><div class="info-item-label">ë°œê¸‰ì¼ì</div><div class="info-item-value" id="issueDate">-</div></div>
                        <div class="info-item"><div class="info-item-label">ìœ íš¨ê¸°ê°„</div><div class="info-item-value" id="expiryDate">-</div></div>
                        <div class="info-item"><div class="info-item-label">ë°œê¸‰ê¸°ê´€</div><div class="info-item-value">ìš¸ì‚°ê´‘ì—­ì‹œ</div></div>
                        <div class="info-item"><div class="info-item-label">ìš©ë„</div><div class="info-item-value">ê³ ë˜ ê´€ì°°</div></div>
                    </div>
                    <div class="license-number" id="licenseNumber" style="text-align:center;font-family:'Courier New',monospace;letter-spacing:2px;margin-top:20px;">UW-2025-000000</div>
                    <div style="text-align:center;margin:15px 0;"><svg id="barcodeSvg"></svg></div>
                </div>
            </div>
            <div class="download-section" style="text-align:center; margin-top:20px;">
                <button class="btn-download" onclick="downloadLicense()" style="background:linear-gradient(135deg,#667eea,#764ba2);color:white;padding:15px 40px;border:none;border-radius:30px;cursor:pointer;">
                    ğŸ“¥ ë©´í—ˆì¦ ë‹¤ìš´ë¡œë“œ
                </button>
            </div>
        </div>
    </div>

    <!-- í”Œë¡œíŒ… ë²„íŠ¼ -->
    <div class="floating-buttons" style="position:fixed;bottom:20px;right:20px;display:flex;flex-direction:column;gap:10px;">
        <button class="float-btn share" onclick="shareToSNS()" title="SNS ê³µìœ " style="background:linear-gradient(135deg,#4facfe,#00f2fe);color:white;">ğŸ“±</button>
        <button class="float-btn admin" onclick="toggleAdmin()" title="ê´€ë¦¬ì" style="background:#2c3e50;color:white;display:none;">âš™ï¸</button>
    </div>

    <!-- ê´€ë¦¬ì íŒ¨ë„ -->
    <div id="adminPanel" style="display:none;position:fixed;top:0;right:0;width:320px;height:100vh;background:white;box-shadow:-5px 0 20px rgba(0,0,0,0.1);overflow-y:auto;z-index:1000;">
        <div style="display:flex;justify-content:space-between;align-items:center;padding:20px;background:#2c3e50;color:white;">
            <h3>ğŸ‹ ê´€ë¦¬ì ëª¨ë“œ</h3>
            <button onclick="toggleAdmin()" style="font-size:24px;color:white;border:none;background:none;cursor:pointer;">Ã—</button>
        </div>
        <div style="padding:20px;">
            <div style="margin-bottom:15px;">
                <div style="font-size:14px;color:#666;">ì˜¤ëŠ˜ ë°œê¸‰ ìˆ˜</div>
                <div id="todayCount" style="font-size:32px;font-weight:700;color:#2a5298;">0</div>
            </div>
            <div style="margin-bottom:15px;">
                <div style="font-size:14px;color:#666;">ì „ì²´ ë°œê¸‰ ìˆ˜</div>
                <div id="totalCount" style="font-size:32px;font-weight:700;color:#2a5298;">0</div>
            </div>
            <div style="margin-bottom:20px;">
                <div style="font-size:14px;color:#666;">ì¸ê¸° ê³ ë˜</div>
                <div id="popularWhale" style="font-size:20px;font-weight:700;color:#2a5298;">-</div>
            </div>
            <button onclick="toggleService()" style="width:100%;padding:12px;border:none;border-radius:8px;background:#dc3545;color:white;cursor:pointer;margin-bottom:10px;">ğŸš« ë°œê¸‰ ì¤‘ì§€/í•´ì œ</button>
        </div>
    </div>

    <script>
    // === ì„¤ì • ===
    const ADMIN_KEY = 'YOUR_SECRET_KEY'; // â† ë°°í¬ ì „ì— ë°˜ë“œì‹œ ë³€ê²½
    // === ì „ì—­ ë³€ìˆ˜ ===
    let todayCount = 0, totalCount = 0;

    // í˜ì´ì§€ ë¡œë“œ ì‹œ
    window.addEventListener('DOMContentLoaded', ()=>{
        const params = new URLSearchParams(location.search);
        if (params.get('admin') === ADMIN_KEY) {
            document.querySelector('.float-btn.admin').style.display = 'flex';
        }
        updateLicense();
    });

    // ì•„ë°”íƒ€ ì„ íƒ
    function selectAvatar(icon, elem) {
        document.querySelectorAll('.avatar-option').forEach(d=>d.classList.remove('selected'));
        elem.classList.add('selected');
        document.getElementById('avatarDisplay').innerText = icon;
    }

    // ë©´í—ˆì¦ ì •ë³´ ì—…ë°ì´íŠ¸
    function updateLicense() {
        const name = document.getElementById('name').value || '-';
        const birth = document.getElementById('birthdate').value || '-';
        const whale = document.getElementById('whaleType').value || '-';
        const purpose = document.getElementById('experience').value || '-';

        document.getElementById('displayName').innerText = name;
        document.getElementById('displayBirth').innerText = birth;
        document.getElementById('displayWhale').innerText = whale;
        document.getElementById('displayPurpose').innerText = purpose;

        // ë°œê¸‰ì¼Â·ë§Œë£Œì¼
        const now = new Date();
        const issue = now.toLocaleDateString('ko-KR');
        const exp = new Date(now.getTime()); exp.setFullYear(now.getFullYear()+1);
        document.getElementById('issueDate').innerText = issue;
        document.getElementById('expiryDate').innerText = exp.toLocaleDateString('ko-KR');

        // ë¼ì´ì„ ìŠ¤ ë²ˆí˜¸
        const licNo = `UW-${now.getFullYear()}-${String(Math.floor(Math.random()*1e6)).padStart(6,'0')}`;
        document.getElementById('licenseNumber').innerText = licNo;

        // ë°”ì½”ë“œ ë Œë”ë§
        JsBarcode("#barcodeSvg", licNo, {format:"CODE128", width:2, height:40, displayValue:false});
    }

    // ë‹¤ìš´ë¡œë“œ
    function downloadLicense() {
        html2canvas(document.querySelector('.license-card')).then(canvas=>{
            const link = document.createElement('a');
            link.download = `${document.getElementById('displayName').innerText || 'license'}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
            todayCount++; totalCount++;
            document.getElementById('todayCount').innerText = todayCount;
            document.getElementById('totalCount').innerText = totalCount;
        });
    }

    // SNS ê³µìœ (ê°„ë‹¨ ë³µì‚¬)
    function shareToSNS() {
        const url = location.href.split('?')[0];
        navigator.clipboard.writeText(url).then(_=>{
            alert('í˜ì´ì§€ URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤:\n' + url);
        });
    }

    // ê´€ë¦¬ì íŒ¨ë„ í† ê¸€
    function toggleAdmin() {
        const panel = document.getElementById('adminPanel');
        panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
    }

    // ì„œë¹„ìŠ¤ ë°°ë„ˆ í† ê¸€
    function toggleService() {
        const b = document.getElementById('serviceBanner');
        b.style.display = (b.style.display==='none' ? 'block' : 'none');
    }
    </script>
</body>
</html>
